
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples\02-Maxwell\Maxwell2D_Transient.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_examples_02-Maxwell_Maxwell2D_Transient.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_02-Maxwell_Maxwell2D_Transient.py:


Maxwell 2D: transient winding analysis
--------------------------------------
This example shows how you can use PyAEDT to create a project in Maxwell 2D
and run a transient simulation. It runs only on Windows using CPython.

The following libraries are required for the advanced postprocessing features
used in this example:

- `Matplotlib <https://pypi.org/project/matplotlib/>`_
- `Numpty <https://pypi.org/project/numpy/>`_
- `PyVista <https://pypi.org/project/pyvista/>`_

Install these with:

.. code::

   pip install numpy pyvista matplotlib

.. GENERATED FROM PYTHON SOURCE LINES 21-28

.. code-block:: default

    # Perform required imports
    # ~~~~~~~~~~~~~~~~~~~~~~~~
    # Perform required imports.

    import os
    from pyaedt import Maxwell2d








.. GENERATED FROM PYTHON SOURCE LINES 29-31

Set non-graphical mode
Set non-graphical mode. The default is ``False``.

.. GENERATED FROM PYTHON SOURCE LINES 31-34

.. code-block:: default


    non_graphical = os.getenv("PYAEDT_NON_GRAPHICAL", "False").lower() in ("true", "1", "t")








.. GENERATED FROM PYTHON SOURCE LINES 35-38

Insert Maxwell 2D design and save project
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Insert a Maxwell 2D design and save the project.

.. GENERATED FROM PYTHON SOURCE LINES 38-44

.. code-block:: default


    maxwell_2d = Maxwell2d(solution_type="TransientXY", specified_version="2022.2", non_graphical=non_graphical,
                           new_desktop_session=True)
    project_dir = maxwell_2d.generate_temp_project_directory("Example")
    maxwell_2d.save_project(os.path.join(project_dir, "M2d.aedt"))





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    pyaedt info: Logger Started
    pyaedt info: Launching PyAEDT outside AEDT with CPython and PythonNET.
    pyaedt info: AEDT installation Path C:\Program Files\AnsysEM\v222\Win64.
    pyaedt info: Launching AEDT with module PythonNET.
    pyaedt info: Ansoft.ElectronicsDesktop.2022.2 Started with process ID 13120.
    pyaedt info: Logger file D:\Temp\pyaedt20220722_091734.log in use.
    pyaedt info: pyaedt v0.5.9
    pyaedt info: Python version 3.8.10 (tags/v3.8.10:3d8993a, May  3 2021, 11:48:03) [MSC v.1928 64 bit (AMD64)]
    pyaedt info: Project Project51 has been created.
    pyaedt info: No design is present. Inserting a new design.
    pyaedt info: Added design 'Maxwell 2D_1TY' of type Maxwell 2D.
    pyaedt info: Aedt Objects initialized
    pyaedt info: Variable Manager initialized
    pyaedt info: Design Loaded
    pyaedt info: Successfully loaded project materials !
    pyaedt info: Materials Loaded
    pyaedt info: Project M2d Saved correctly

    True



.. GENERATED FROM PYTHON SOURCE LINES 45-48

Create rectangle and duplicate it
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Create a rectangle and duplicates it.

.. GENERATED FROM PYTHON SOURCE LINES 48-53

.. code-block:: default


    rect1 = maxwell_2d.modeler.create_rectangle([0, 0, 0], [10, 20], name="winding", matname="copper")
    added = rect1.duplicate_along_line([14, 0, 0])
    rect2 = maxwell_2d.modeler[added[0]]








.. GENERATED FROM PYTHON SOURCE LINES 54-57

Create air region
~~~~~~~~~~~~~~~~~
Create an air region.

.. GENERATED FROM PYTHON SOURCE LINES 57-60

.. code-block:: default


    region = maxwell_2d.modeler.create_region([100, 100, 100, 100, 100, 100])








.. GENERATED FROM PYTHON SOURCE LINES 61-64

Assign windings and balloon
~~~~~~~~~~~~~~~~~~~~~~~~~~~
Assigns windings to the sheets and a balloon to the air region.

.. GENERATED FROM PYTHON SOURCE LINES 64-69

.. code-block:: default


    maxwell_2d.assign_winding([rect1.name, rect2.name], name="PHA")
    maxwell_2d.assign_balloon(region.edges)






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    pyaedt info: aedt file load time 0.0

    <pyaedt.modules.Boundary.BoundaryObject object at 0x00000182FC4CD340>



.. GENERATED FROM PYTHON SOURCE LINES 70-73

Plot model
~~~~~~~~~~
Plot the model.

.. GENERATED FROM PYTHON SOURCE LINES 73-77

.. code-block:: default


    maxwell_2d.plot(show=False, export_path=os.path.join(maxwell_2d.working_directory, "Image.jpg"), plot_air_objects=True)





.. image-sg:: /examples/02-Maxwell/images/sphx_glr_Maxwell2D_Transient_001.png
   :alt: Maxwell2D Transient
   :srcset: /examples/02-Maxwell/images/sphx_glr_Maxwell2D_Transient_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    <pyaedt.generic.plot.ModelPlotter object at 0x0000018282A972B0>



.. GENERATED FROM PYTHON SOURCE LINES 78-81

Create setup
~~~~~~~~~~~~
Create the transient setup.

.. GENERATED FROM PYTHON SOURCE LINES 81-90

.. code-block:: default


    setup = maxwell_2d.create_setup()
    setup.props["StopTime"] = "0.02s"
    setup.props["TimeStep"] = "0.0002s"
    setup.props["SaveFieldsType"] = "Every N Steps"
    setup.props["N Steps"] = "1"
    setup.props["Steps From"] = "0s"
    setup.props["Steps To"] = "0.002s"








.. GENERATED FROM PYTHON SOURCE LINES 91-94

Create rectangular plot
~~~~~~~~~~~~~~~~~~~~~~~
Create a rectangular plot.

.. GENERATED FROM PYTHON SOURCE LINES 94-99

.. code-block:: default


    maxwell_2d.post.create_report(
        "InputCurrent(PHA)", domain="Time", primary_sweep_variable="Time", plotname="Winding Plot 1"
    )





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    <pyaedt.modules.report_templates.Standard object at 0x00000182FD977730>



.. GENERATED FROM PYTHON SOURCE LINES 100-103

Solve model
~~~~~~~~~~~
Solve the model.

.. GENERATED FROM PYTHON SOURCE LINES 103-106

.. code-block:: default


    maxwell_2d.analyze_nominal(use_auto_settings=False)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    pyaedt info: Solving design setup MySetupAuto
    pyaedt info: Design setup MySetupAuto solved correctly

    True



.. GENERATED FROM PYTHON SOURCE LINES 107-110

Create output and plot using PyVista
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Create the output and plot it using PyVista.

.. GENERATED FROM PYTHON SOURCE LINES 110-136

.. code-block:: default


    cutlist = ["Global:XY"]
    face_lists = rect1.faces
    face_lists += rect2.faces
    timesteps = [str(i * 2e-4) + "s" for i in range(11)]
    id_list = [f.id for f in face_lists]
    animatedGif = maxwell_2d.post.animate_fields_from_aedtplt_2(
        "Mag_B",
        id_list,
        "Surface",
        intrinsic_dict={"Time": "0s"},
        variation_variable="Time",
        variation_list=timesteps,
        show=False,
        export_gif=False,
    )
    animatedGif.isometric_view = False
    animatedGif.camera_position = [15, 15, 80]
    animatedGif.focal_point = [15, 15, 0]
    animatedGif.roll_angle = 0
    animatedGif.elevation_angle = 0
    animatedGif.azimuth_angle = 0
    # Set off_screen to False to visualize the animation.
    # animatedGif.off_screen = False
    animatedGif.animate()




.. image-sg:: /examples/02-Maxwell/images/sphx_glr_Maxwell2D_Transient_002.png
   :alt: Maxwell2D Transient
   :srcset: /examples/02-Maxwell/images/sphx_glr_Maxwell2D_Transient_002.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    True



.. GENERATED FROM PYTHON SOURCE LINES 137-140

Generate plot outside of AEDT
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Generate the same plot outside of AEDT.

.. GENERATED FROM PYTHON SOURCE LINES 140-144

.. code-block:: default


    solutions = maxwell_2d.post.get_solution_data("InputCurrent(PHA)", primary_sweep_variable="Time")
    solutions.plot()




.. image-sg:: /examples/02-Maxwell/images/sphx_glr_Maxwell2D_Transient_003.png
   :alt: Simulation Results Plot
   :srcset: /examples/02-Maxwell/images/sphx_glr_Maxwell2D_Transient_003.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    pyaedt info: Solution Data Correctly Loaded.

    <Figure size 2000x1000 with 1 Axes>



.. GENERATED FROM PYTHON SOURCE LINES 145-148

Close AEDT
~~~~~~~~~~
Close AEDT.

.. GENERATED FROM PYTHON SOURCE LINES 148-150

.. code-block:: default


    maxwell_2d.release_desktop()




.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    True




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  39.366 seconds)


.. _sphx_glr_download_examples_02-Maxwell_Maxwell2D_Transient.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: Maxwell2D_Transient.py <Maxwell2D_Transient.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: Maxwell2D_Transient.ipynb <Maxwell2D_Transient.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
