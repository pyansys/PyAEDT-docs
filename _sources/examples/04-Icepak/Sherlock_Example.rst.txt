
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples\04-Icepak\Sherlock_Example.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_examples_04-Icepak_Sherlock_Example.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_04-Icepak_Sherlock_Example.py:


Icepack: setup from Sherlock inputs
-----------------------------------
This example shows how to create an Icepak project starting from Sherlock
files (STEP and CSV) and an AEDB board.

.. GENERATED FROM PYTHON SOURCE LINES 8-11

Perform required imports
~~~~~~~~~~~~~~~~~~~~~~~~
Perform required imports and set paths.

.. GENERATED FROM PYTHON SOURCE LINES 11-29

.. code-block:: default


    import time
    import os
    import tempfile
    import datetime

    from pyaedt import examples, generate_unique_name

    # Set paths
    input_dir = examples.download_sherlock()
    tmpfold = tempfile.gettempdir()


    temp_folder = os.path.join(tmpfold, generate_unique_name("Example"))
    if not os.path.exists(temp_folder):
        os.makedirs(temp_folder)
    print(temp_folder)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    D:\Temp\Example_267K3X




.. GENERATED FROM PYTHON SOURCE LINES 30-33

Set non-graphical mode
~~~~~~~~~~~~~~~~~~~~~~
Set non-graphical mode. The default is ``False``.

.. GENERATED FROM PYTHON SOURCE LINES 33-36

.. code-block:: default


    non_graphical = os.getenv("PYAEDT_NON_GRAPHICAL", "False").lower() in ("true", "1", "t")








.. GENERATED FROM PYTHON SOURCE LINES 37-41

Input variables
~~~~~~~~~~~~~~~
Input variables. The following code creates all input variables that are needed
to run this example.

.. GENERATED FROM PYTHON SOURCE LINES 41-50

.. code-block:: default


    material_name = "MaterialExport.csv"
    component_properties = "TutorialBoardPartsList.csv"
    component_step = "TutorialBoard.stp"
    aedt_odb_project = "SherlockTutorial.aedt"
    aedt_odb_design_name = "PCB"
    stackup_thickness = 2.11836
    outline_polygon_name = "poly_14188"








.. GENERATED FROM PYTHON SOURCE LINES 51-54

Import Icepak and AEDT
~~~~~~~~~~~~~~~~~~~~~~
Import Icepak and AEDT.

.. GENERATED FROM PYTHON SOURCE LINES 54-58

.. code-block:: default


    from pyaedt import Icepak
    from pyaedt import Desktop








.. GENERATED FROM PYTHON SOURCE LINES 59-62

Launch AEDT
~~~~~~~~~~~
Launch AEDT 2022 R2 in graphical mode.

.. GENERATED FROM PYTHON SOURCE LINES 62-72

.. code-block:: default


    d = Desktop("2022.2", non_graphical=non_graphical, new_desktop_session=True)

    start = time.time()
    material_list = os.path.join(input_dir, material_name)
    component_list = os.path.join(input_dir, component_properties)
    validation = os.path.join(temp_folder, "validation.log")
    file_path = os.path.join(input_dir, component_step)
    project_name = os.path.join(temp_folder, component_step[:-3] + "aedt")





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    pyaedt info: Logger Started
    pyaedt info: Launching PyAEDT outside AEDT with CPython and PythonNET.
    pyaedt info: AEDT installation Path C:\Program Files\AnsysEM\v222\Win64.
    pyaedt info: Launching AEDT with module PythonNET.
    pyaedt info: Ansoft.ElectronicsDesktop.2022.2 Started with process ID 7052.
    pyaedt info: Logger file D:\Temp\pyaedt20220722_091734.log in use.
    pyaedt info: pyaedt v0.5.9
    pyaedt info: Python version 3.8.10 (tags/v3.8.10:3d8993a, May  3 2021, 11:48:03) [MSC v.1928 64 bit (AMD64)]




.. GENERATED FROM PYTHON SOURCE LINES 73-76

Create Icepak project
~~~~~~~~~~~~~~~~~~~~~
Create an Icepak project.

.. GENERATED FROM PYTHON SOURCE LINES 76-79

.. code-block:: default


    ipk = Icepak()





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    pyaedt info: Project Project52 has been created.
    pyaedt info: No design is present. Inserting a new design.
    pyaedt info: Added design 'Icepak_45U' of type Icepak.
    pyaedt info: Aedt Objects initialized
    pyaedt info: Variable Manager initialized
    pyaedt info: Design Loaded
    pyaedt info: Successfully loaded project materials !
    pyaedt info: Materials Loaded




.. GENERATED FROM PYTHON SOURCE LINES 80-83

Delete region to speed up import
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Delete the region and disable autosave to speed up the import.

.. GENERATED FROM PYTHON SOURCE LINES 83-88

.. code-block:: default


    d.disable_autosave()
    ipk.modeler.delete("Region")
    component_name = "from_ODB"





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    pyaedt info: Deleted 1 Objects: Region.




.. GENERATED FROM PYTHON SOURCE LINES 89-92

Import PCB from AEDB file
~~~~~~~~~~~~~~~~~~~~~~~~~
Import a PCB from an AEDB file.

.. GENERATED FROM PYTHON SOURCE LINES 92-98

.. code-block:: default


    odb_path = os.path.join(input_dir, aedt_odb_project)
    ipk.create_pcb_from_3dlayout(
        component_name, odb_path, aedt_odb_design_name, extenttype="Polygon", outlinepolygon=outline_polygon_name
    )





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    pyaedt info: Closing the AEDT Project SherlockTutorial
    pyaedt info: Project SherlockTutorial closed correctly
    pyaedt info: PCB component correctly created in Icepak.

    <pyaedt.modules.Boundary.NativeComponentObject object at 0x00000182827FEC10>



.. GENERATED FROM PYTHON SOURCE LINES 99-103

Create offset coordinate system
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Create an offset coordinate system to match ODB++ with the
Sherlock STEP file.

.. GENERATED FROM PYTHON SOURCE LINES 103-106

.. code-block:: default


    ipk.modeler.create_coordinate_system([0, 0, stackup_thickness / 2], mode="view", view="XY")





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    <pyaedt.modeler.Modeler.CoordinateSystem object at 0x000001828F0EF580>



.. GENERATED FROM PYTHON SOURCE LINES 107-110

Import CAD file
~~~~~~~~~~~~~~~
Import a CAD file.

.. GENERATED FROM PYTHON SOURCE LINES 110-113

.. code-block:: default


    ipk.modeler.import_3d_cad(file_path, refresh_all_ids=False)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    pyaedt info: Step file D:\Temp\PyAEDTExamples\sherlock\TutorialBoard.stp imported

    True



.. GENERATED FROM PYTHON SOURCE LINES 114-117

Save CAD file
~~~~~~~~~~~~~
Save the CAD file and refresh the properties from the parsing of the AEDT file.

.. GENERATED FROM PYTHON SOURCE LINES 117-121

.. code-block:: default


    ipk.save_project(project_name, refresh_obj_ids_after_save=True)






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    pyaedt info: aedt file load time 0.29695987701416016
    pyaedt error: User-defined models were not retrieved from the AEDT file.
    User-defined models were not retrieved from the AEDT file.
    pyaedt info: Project TutorialBoard Saved correctly

    True



.. GENERATED FROM PYTHON SOURCE LINES 122-125

Plot model
~~~~~~~~~~
Plot the model.

.. GENERATED FROM PYTHON SOURCE LINES 125-129

.. code-block:: default


    ipk.plot(show=False, export_path=os.path.join(temp_folder, "Sherlock_Example.jpg"), plot_air_objects=False)





.. image-sg:: /examples/04-Icepak/images/sphx_glr_Sherlock_Example_001.png
   :alt: Sherlock Example
   :srcset: /examples/04-Icepak/images/sphx_glr_Sherlock_Example_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    pyaedt error: User-defined models were not retrieved from the AEDT file.
    User-defined models were not retrieved from the AEDT file.

    <pyaedt.generic.plot.ModelPlotter object at 0x000001828EA5EA30>



.. GENERATED FROM PYTHON SOURCE LINES 130-133

Delete PCB objects
~~~~~~~~~~~~~~~~~~
Delete the PCB objects.

.. GENERATED FROM PYTHON SOURCE LINES 133-136

.. code-block:: default


    ipk.modeler.delete_objects_containing("pcb", False)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    pyaedt info: Deleted 1 Objects: PCB.
    pyaedt info: Deleted 1 objects

    True



.. GENERATED FROM PYTHON SOURCE LINES 137-140

Create region
~~~~~~~~~~~~~
Create an air region.

.. GENERATED FROM PYTHON SOURCE LINES 140-143

.. code-block:: default


    ipk.modeler.create_air_region(*[20, 20, 300, 20, 20, 300])





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    <pyaedt.modeler.Object3d.Object3d object at 0x00000182940E1AC0>



.. GENERATED FROM PYTHON SOURCE LINES 144-147

Assign materials
~~~~~~~~~~~~~~~~
Assign materials from the the Sherlock file.

.. GENERATED FROM PYTHON SOURCE LINES 147-150

.. code-block:: default


    ipk.assignmaterial_from_sherlock_files(component_list, material_list)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    pyaedt info: Adding new material to the Project Library: alumina
    pyaedt info: Material has been added. Edit it to update in Desktop.
    pyaedt info: Adding new material to the Project Library: bariumtitanate
    pyaedt info: Material has been added. Edit it to update in Desktop.
    pyaedt info: Adding new material to the Project Library: epoxyencapsulant
    pyaedt info: Material has been added. Edit it to update in Desktop.
    pyaedt info: Adding new material to the Project Library: laminate-bga
    pyaedt info: Material has been added. Edit it to update in Desktop.
    pyaedt info: Dataset Mass_Density_1EBHXJ doesn't exist.
    pyaedt info: Dataset $Mass_Density_1EBHXJ created successfully.
    pyaedt info: Dataset Youngs_Modulus_NZTR6J doesn't exist.
    pyaedt info: Dataset $Youngs_Modulus_NZTR6J created successfully.

    True



.. GENERATED FROM PYTHON SOURCE LINES 151-154

Delete objects with no material assignments
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Delete objects with no materials assignments.

.. GENERATED FROM PYTHON SOURCE LINES 154-159

.. code-block:: default


    no_material_objs = ipk.modeler.get_objects_by_material("")
    ipk.modeler.delete(no_material_objs)
    ipk.save_project()





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    pyaedt warning: No objects to delete
    No objects to delete
    pyaedt info: Project TutorialBoard Saved correctly

    True



.. GENERATED FROM PYTHON SOURCE LINES 160-163

Assign power to component blocks
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Assign power to component blocks.

.. GENERATED FROM PYTHON SOURCE LINES 163-166

.. code-block:: default


    all_objects = ipk.modeler.object_names








.. GENERATED FROM PYTHON SOURCE LINES 167-170

Assign power blocks
~~~~~~~~~~~~~~~~~~~
Assign power blocks from the Sherlock file.

.. GENERATED FROM PYTHON SOURCE LINES 170-174

.. code-block:: default


    total_power = ipk.assign_block_from_sherlock_file(component_list)






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    pyaedt info: Block on ['COMP_R1'] with 1.0W power created correctly.
    pyaedt info: Block on ['COMP_R2'] with 1.0W power created correctly.
    pyaedt info: Block on ['COMP_R3'] with 1.0W power created correctly.
    pyaedt info: Block on ['COMP_R4'] with 1.0W power created correctly.
    pyaedt info: Block on ['COMP_R5'] with 1.0W power created correctly.
    pyaedt info: Block on ['COMP_R6'] with 1.0W power created correctly.
    pyaedt info: Block on ['COMP_R7'] with 1.0W power created correctly.
    pyaedt info: Block on ['COMP_R8'] with 1.0W power created correctly.
    pyaedt info: Block on ['COMP_R9'] with 1.0W power created correctly.
    pyaedt info: Block on ['COMP_R10'] with 1.0W power created correctly.
    pyaedt info: Block on ['COMP_R11'] with 1.0W power created correctly.
    pyaedt info: Block on ['COMP_R12'] with 1.0W power created correctly.
    pyaedt info: Block on ['COMP_R13'] with 1.0W power created correctly.
    pyaedt info: Block on ['COMP_R14'] with 1.0W power created correctly.
    pyaedt info: Block on ['COMP_R15'] with 1.0W power created correctly.
    pyaedt info: Block on ['COMP_R16'] with 1.0W power created correctly.
    pyaedt info: Block on ['COMP_R17'] with 1.0W power created correctly.
    pyaedt info: Block on ['COMP_R18'] with 1.0W power created correctly.
    pyaedt info: Block on ['COMP_R19'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R20'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R21'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R22'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R23'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R24'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R25'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R26'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R27'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R28'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R29'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R30'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R31'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R32'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R33'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R34'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R35'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R36'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R37'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R38'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R39'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R40'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R41'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R42'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R43'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R44'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R45'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R46'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R47'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R48'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R49'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R50'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R51'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R52'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R53'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R54'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R55'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R56'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R57'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R58'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R59'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R60'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R61'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R62'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R63'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R64'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R65'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R66'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R67'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R68'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R69'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R70'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R71'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R72'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R73'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R74'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R75'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R76'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R77'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R78'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R79'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R80'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R81'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R82'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R83'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R84'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R85'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R86'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R87'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R88'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R89'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R90'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R91'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R92'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R93'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R94'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R95'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R96'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R97'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R98'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R99'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R100'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R101'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R102'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R103'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R104'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R105'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R106'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R107'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R108'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R109'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R110'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R111'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R112'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R113'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R114'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R115'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R116'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R117'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R118'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R119'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R120'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R121'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R122'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R123'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R124'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R125'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R126'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R127'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R128'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R129'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R130'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R131'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R132'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R133'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R134'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R135'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R136'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R137'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R138'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R139'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R140'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R141'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R142'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R143'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R144'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R145'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R146'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R147'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R148'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R149'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R150'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R151'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R152'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R153'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R154'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R155'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R156'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R157'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_R158'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_U9'] with 1.0W power created correctly.
    pyaedt info: Block on ['COMP_U10'] with 1.0W power created correctly.
    pyaedt info: Block on ['COMP_U11'] with 0.1W power created correctly.
    pyaedt info: Block on ['COMP_U12'] with 0.1W power created correctly.
    pyaedt info: Blocks inserted with total power 34.2000000000002W.




.. GENERATED FROM PYTHON SOURCE LINES 175-178

Plot model
~~~~~~~~~~
Plot the model again now that materials are assigned.

.. GENERATED FROM PYTHON SOURCE LINES 178-182

.. code-block:: default


    ipk.plot(show=False, export_path=os.path.join(temp_folder, "Sherlock_Example.jpg"), plot_air_objects=False)





.. image-sg:: /examples/04-Icepak/images/sphx_glr_Sherlock_Example_002.png
   :alt: Sherlock Example
   :srcset: /examples/04-Icepak/images/sphx_glr_Sherlock_Example_002.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    pyaedt error: User-defined models were not retrieved from the AEDT file.
    User-defined models were not retrieved from the AEDT file.

    <pyaedt.generic.plot.ModelPlotter object at 0x00000182827FEA30>



.. GENERATED FROM PYTHON SOURCE LINES 183-186

Set up boundaries
~~~~~~~~~~~~~~~~~
Set up boundaries.

.. GENERATED FROM PYTHON SOURCE LINES 186-196

.. code-block:: default


    ipk.mesh.automatic_mesh_pcb(4)

    setup1 = ipk.create_setup()
    setup1.props["Solution Initialization - Y Velocity"] = "1m_per_sec"
    setup1.props["Radiation Model"] = "Discrete Ordinates Model"
    setup1.props["Include Gravity"] = True
    setup1.props["Secondary Gradient"] = True
    ipk.assign_openings(ipk.modeler.get_object_faces("Region"))





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    pyaedt info: Opening Assigned

    <pyaedt.modules.Boundary.BoundaryObject object at 0x0000018292158BE0>



.. GENERATED FROM PYTHON SOURCE LINES 197-201

Check for intersections
~~~~~~~~~~~~~~~~~~~~~~~
Check for intersections using validation and fix them by
assigning priorities.

.. GENERATED FROM PYTHON SOURCE LINES 201-204

.. code-block:: default


    ipk.assign_priority_on_intersections()





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    pyaedt info: Project TutorialBoard Saved correctly

    True



.. GENERATED FROM PYTHON SOURCE LINES 205-208

Save project and release AEDT
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Save the project and release AEDT.

.. GENERATED FROM PYTHON SOURCE LINES 208-216

.. code-block:: default


    ipk.save_project()

    end = time.time() - start
    if os.name != "posix":
        ipk.release_desktop()
    print("Elapsed time: {}".format(datetime.timedelta(seconds=end)))
    print("Project Saved in {} ".format(temp_folder))




.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    pyaedt info: Project TutorialBoard Saved correctly
    Elapsed time: 0:00:46.165001
    Project Saved in D:\Temp\Example_267K3X 





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  52.293 seconds)


.. _sphx_glr_download_examples_04-Icepak_Sherlock_Example.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: Sherlock_Example.py <Sherlock_Example.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: Sherlock_Example.ipynb <Sherlock_Example.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
