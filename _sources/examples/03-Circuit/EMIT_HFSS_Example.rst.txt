
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples\03-Circuit\EMIT_HFSS_Example.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_examples_03-Circuit_EMIT_HFSS_Example.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_03-Circuit_EMIT_HFSS_Example.py:


EMIT: HFSS to EMIT coupling
---------------------------
This tutorial shows how you can use PyAEDT to open an AEDT project with
an HFSS design, create an EMIT design in the project, and link the HFSS design
as a coupling link in the EMIT design.

.. GENERATED FROM PYTHON SOURCE LINES 9-12

Perform required imports
~~~~~~~~~~~~~~~~~~~~~~~~
Perform required imports.

.. GENERATED FROM PYTHON SOURCE LINES 12-24

.. code-block:: default


    # sphinx_gallery_thumbnail_path = 'Resources/emit.png'
    import os
    import tempfile

    # Import required modules
    from pyaedt.generic.filesystem import Scratch

    from pyaedt import Emit
    from pyaedt import Desktop









.. GENERATED FROM PYTHON SOURCE LINES 25-30

Specify initialization settings
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Change the ``non_graphical`` Boolean variable to ``False`` to open AEDT in
graphical mode. With ``NewThread = False``, an existing instance of AEDT
is used if one is available. The following code uses AEDT 2022 R2.

.. GENERATED FROM PYTHON SOURCE LINES 30-36

.. code-block:: default


    non_graphical = os.getenv("PYAEDT_NON_GRAPHICAL", "False").lower() in ("true", "1", "t")
    NewThread = True
    desktop_version = "2022.2"
    scratch_path = tempfile.gettempdir()








.. GENERATED FROM PYTHON SOURCE LINES 37-43

Launch AEDT with EMIT
~~~~~~~~~~~~~~~~~~~~~
Launch AEDT with EMIT. The ``Desktop`` class initializes AEDT and starts it
on the specified version and in the specified graphical mode. The ``NewThread``
Boolean variable defines whether to create a new instance of AEDT or try to
connect to existing instance of it if one is available.

.. GENERATED FROM PYTHON SOURCE LINES 43-85

.. code-block:: default


    d = Desktop(desktop_version, non_graphical, NewThread)

    temp_folder = os.path.join(scratch_path, ("EmitHFSSExample"))
    if not os.path.exists(temp_folder):
        os.mkdir(temp_folder)

    example_name = "Cell Phone RFI Desense"
    example_aedt = example_name + ".aedt"
    example_lock = example_aedt + ".lock"
    example_pdf_file = example_name + " Example.pdf"

    example_dir = os.path.join(d.install_path, "Examples\\EMIT")
    example_project = os.path.join(example_dir, example_aedt)
    example_pdf = os.path.join(example_dir, example_pdf_file)

    # If the ``Cell Phone RFT Defense`` example is not in the installation directory, exit from this example.
    if not os.path.exists(example_project):
        msg = """
            Cell phone RFT Desense example file is not in the
             Examples/EMIT directory under the EDT installation. You cannot run this example.
            """
        print(msg)
        d.release_desktop(True, True)
        exit()

    my_project = os.path.join(temp_folder, example_aedt)
    my_project_lock = os.path.join(temp_folder, example_lock)
    my_project_pdf = os.path.join(temp_folder, example_pdf_file)

    if os.path.exists(my_project):
        os.remove(my_project)

    if os.path.exists(my_project_lock):
        os.remove(my_project_lock)

    with Scratch(scratch_path) as local_scratch:
        local_scratch.copyfile(example_project, my_project)
        if os.path.exists(example_pdf):
            local_scratch.copyfile(example_pdf, my_project_pdf)

    aedtapp = Emit(my_project)




.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    pyaedt info: Logger Started
    pyaedt info: Launching PyAEDT outside AEDT with CPython and PythonNET.
    pyaedt info: AEDT installation Path C:\Program Files\AnsysEM\v222\Win64.
    pyaedt info: Launching AEDT with module PythonNET.
    pyaedt info: Ansoft.ElectronicsDesktop.2022.2 Started with process ID 11520.
    pyaedt info: Logger file D:\Temp\pyaedt20220722_091734.log in use.
    pyaedt info: pyaedt v0.5.9
    pyaedt info: Python version 3.8.10 (tags/v3.8.10:3d8993a, May  3 2021, 11:48:03) [MSC v.1928 64 bit (AMD64)]
    pyaedt info: Project Cell Phone RFI Desense has been opened.
    pyaedt info: Active Design set to EMIT Design1
    pyaedt info: Aedt Objects initialized
    pyaedt info: Variable Manager initialized




.. GENERATED FROM PYTHON SOURCE LINES 86-89

Create and connect EMIT components
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Create three radios and connect an antenna to each one.

.. GENERATED FROM PYTHON SOURCE LINES 89-100

.. code-block:: default


    rad1 = aedtapp.modeler.components.create_component("UE - Handheld")
    ant1 = aedtapp.modeler.components.create_component("Antenna")
    if rad1 and ant1:
        ant1.move_and_connect_to(rad1)

    rad2 = aedtapp.modeler.components.create_component("GPS Receiver")
    ant2 = aedtapp.modeler.components.create_component("Antenna")
    if rad2 and ant2:
        ant2.move_and_connect_to(rad2)








.. GENERATED FROM PYTHON SOURCE LINES 101-104

Define coupling among RF systems
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Define coupling among the RF systems.

.. GENERATED FROM PYTHON SOURCE LINES 104-110

.. code-block:: default


    for link in aedtapp.couplings.linkable_design_names:
        aedtapp.couplings.add_link(link)

    for link in aedtapp.couplings.coupling_names:
        aedtapp.couplings.update_link(link)







.. GENERATED FROM PYTHON SOURCE LINES 111-114

Run EMIT simulation
~~~~~~~~~~~~~~~~~~~
Run the EMIT simulation. This portion of the EMIT API is not yet implemented.

.. GENERATED FROM PYTHON SOURCE LINES 117-122

Save project and close AEDT
~~~~~~~~~~~~~~~~~~~~~~~~~~~
After the simulaton completes, you can close AEDT or release it using the
:func:`pyaedt.Desktop.force_close_desktop` method.
All methods provide for saving the project before closing.

.. GENERATED FROM PYTHON SOURCE LINES 122-125

.. code-block:: default


    aedtapp.save_project()
    aedtapp.release_desktop(close_projects=True, close_desktop=True)




.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    pyaedt info: Project Cell Phone RFI Desense Saved correctly

    True




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  15.377 seconds)


.. _sphx_glr_download_examples_03-Circuit_EMIT_HFSS_Example.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: EMIT_HFSS_Example.py <EMIT_HFSS_Example.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: EMIT_HFSS_Example.ipynb <EMIT_HFSS_Example.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
